<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Thai Sentiment Analysis</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#f9fafb;
  --card:#ffffff;
  --border:#e5e7eb;
  --primary:#7c83fd;

  --pos-bg:#e8f8f1;
  --pos-text:#047857;
  --neu-bg:#fff6e5;
  --neu-text:#92400e;
  --neg-bg:#fdecec;
  --neg-text:#b91c1c;
}

*{
  box-sizing:border-box;
  font-family: Inter, system-ui, sans-serif;
}

body{
  margin:0;
  background:linear-gradient(180deg,#f9fafb,#f3f4f6);
  color:#1f2937;
}

.container{
  max-width:1100px;
  margin:40px auto;
  padding:0 20px;
}

h1{font-size:34px;margin-bottom:6px;}
.subtitle{color:#6b7280;margin-bottom:28px;}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:20px;
  padding:26px;
  margin-bottom:26px;
}

textarea{
  width:100%;
  height:120px;
  padding:16px;
  border-radius:16px;
  border:1px solid var(--border);
  resize:none;
  font-size:16px;
}

.chips{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px;}
.chip{
  padding:8px 14px;
  border-radius:999px;
  font-size:14px;
  cursor:pointer;
  border:1px solid var(--border);
}
.chip.pos{background:var(--pos-bg);color:var(--pos-text);}
.chip.neu{background:var(--neu-bg);color:var(--neu-text);}
.chip.neg{background:var(--neg-bg);color:var(--neg-text);}
.chip.mix{background:#eef2ff;color:#4338ca;}

.actions{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:18px;
}

.left-actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

button,.link-btn{
  border:none;
  border-radius:999px;
  padding:12px 22px;
  font-size:14px;
  font-weight:600;
  cursor:pointer;
  text-decoration:none;
  display:inline-flex;
  align-items:center;
  justify-content:center;
}

button.primary{background:var(--primary);color:white;}
button.secondary,.link-btn{background:#e5e7eb;color:#374151;}

.results{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:22px;
}

.result-card{
  border-radius:18px;
  padding:22px;
  border:1px solid var(--border);
}

.badge{
  display:inline-block;
  padding:6px 14px;
  border-radius:999px;
  font-weight:700;
  margin-bottom:10px;
}

.progress{
  height:10px;
  background:#e5e7eb;
  border-radius:999px;
  overflow:hidden;
  margin:10px 0;
}

.progress div{height:100%;}
.hidden{display:none;}
</style>
</head>

<body>
<div class="container">

<h1>Thai Sentiment Analysis üåà</h1>
<div class="subtitle">Machine Learning Web Deployment</div>

<div class="card">
<label>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</label>
<textarea id="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå sentiment..."></textarea>

<div class="chips">
  <span class="chip pos" onclick="setText(randomBy('pos'))">üòä ‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å</span>
  <span class="chip neu" onclick="setText(randomBy('neu'))">üòê ‡∏Å‡∏•‡∏≤‡∏á</span>
  <span class="chip neg" onclick="setText(randomBy('neg'))">üò° ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö</span>
  <span class="chip mix" onclick="setText(randomBy('mix'))">üòï ‡∏õ‡∏£‡∏∞‡∏ä‡∏î</span>
</div>

<div class="actions">
  <div class="left-actions">
    <button class="primary" onclick="analyze()">Predict</button>
    <button class="secondary" onclick="setText(randomAny())">üé≤ ‡∏™‡∏∏‡πà‡∏°‡∏£‡∏ß‡∏°</button>

    <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Error -->
    <a href="/errors" class="link-btn">üìä Error Analysis</a>
  </div>

  <label>
    <input type="checkbox" id="abToggle"> A / B comparison
  </label>
</div>
</div>

<div id="results" class="results hidden">
  <div id="modelA" class="result-card"></div>
  <div id="modelB" class="result-card"></div>
</div>

</div>

<script>
const samples={
  pos:["‡∏£‡πâ‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à‡∏™‡∏∏‡∏î‡πÜ üòä","‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å"],
  neu:["‡πÄ‡∏â‡∏¢‡πÜ","‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤"],
  neg:["‡πÅ‡∏¢‡πà‡∏°‡∏≤‡∏Å","‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à‡πÄ‡∏•‡∏¢"],
  mix:["‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡∏µ‡πÅ‡∏ï‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡πâ‡∏≤"]
};

function randomBy(t){
  const a=samples[t];
  return a[Math.floor(Math.random()*a.length)];
}

function randomAny(){
  return Object.values(samples).flat()
    [Math.floor(Math.random()*Object.values(samples).flat().length)];
}

function setText(t){
  document.getElementById("text").value=t;
}

function styleByLabel(l){
  if(l==="Positive") return ["var(--pos-bg)","var(--pos-text)"];
  if(l==="Negative") return ["var(--neg-bg)","var(--neg-text)"];
  return ["var(--neu-bg)","var(--neu-text)"];
}

function render(el,d){
  const [bg,txt]=styleByLabel(d.label);
  el.style.background=bg;
  el.innerHTML=`
    <div class="badge" style="background:${bg};color:${txt}">
      ${d.label.toUpperCase()}
    </div>
    <div class="progress">
      <div style="width:${d.confidence*100}%;background:${txt}"></div>
    </div>
    <div>
      Confidence: ${(d.confidence*100).toFixed(2)}%<br>
      Latency: ${d.latency_ms} ms<br>
      Model: ${d.name} (${d.version})
    </div>`;
}

async function analyze(){
  const text=document.getElementById("text").value;
  const ab=document.getElementById("abToggle").checked;
  document.getElementById("results").classList.remove("hidden");

  if(ab){
    const r=await fetch("/predict_ab",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({text})
    });
    const d=await r.json();
    render(modelA,d.model_a);
    render(modelB,d.model_b);
  }else{
    const r=await fetch("/predict",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({text})
    });
    const d=await r.json();
    render(modelA,d);
    modelB.innerHTML="";
  }
}
</script>

</body>
</html>
