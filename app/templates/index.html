<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Thai Sentiment Analysis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --bg:#f9fafb;
      --card:#ffffff;
      --border:#e5e7eb;
      --primary:#7c83fd;

      --pos-bg:#e8f8f1;
      --pos-text:#047857;

      --neu-bg:#fff6e5;
      --neu-text:#92400e;

      --neg-bg:#fdecec;
      --neg-text:#b91c1c;
    }

    * {
      box-sizing: border-box;
      font-family: Inter, system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    body {
      margin: 0;
      background: linear-gradient(180deg,#f9fafb,#f3f4f6);
      color: #1f2937;
    }

    .container {
      max-width: 1100px;
      margin: 40px auto;
      padding: 0 20px;
    }

    h1 {
      font-size: 34px;
      margin-bottom: 6px;
    }

    .subtitle {
      color: #6b7280;
      margin-bottom: 28px;
    }

    /* ---------- CARD ---------- */
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 26px;
      margin-bottom: 26px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.04);
    }

    label {
      font-weight: 600;
      margin-bottom: 8px;
      display: block;
    }

    textarea {
      width: 100%;
      height: 120px;
      padding: 16px;
      border-radius: 16px;
      border: 1px solid var(--border);
      resize: none;
      font-size: 16px;
      background: #fafafa;
    }

    textarea:focus {
      outline: none;
      border-color: var(--primary);
      background: white;
    }

    /* ---------- CHIPS ---------- */
    .chips {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 14px;
    }

    .chip {
      padding: 8px 14px;
      border-radius: 999px;
      font-size: 14px;
      cursor: pointer;
      border: 1px solid var(--border);
      transition: .15s;
    }

    .chip:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }

    .chip.pos { background: var(--pos-bg); color: var(--pos-text); }
    .chip.neu { background: var(--neu-bg); color: var(--neu-text); }
    .chip.neg { background: var(--neg-bg); color: var(--neg-text); }
    .chip.mix { background: #eef2ff; color: #4338ca; }

    /* ---------- ACTIONS ---------- */
    .actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 18px;
    }

    .left-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 12px 22px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
    }

    button.primary {
      background: var(--primary);
      color: white;
    }

    button.secondary {
      background: #e5e7eb;
      color: #374151;
    }

    .toggle {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      color: #4b5563;
    }

    /* ---------- RESULTS ---------- */
    .results {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 22px;
      margin-top: 20px;
    }

    .result-card {
      border-radius: 18px;
      padding: 22px;
      border: 1px solid var(--border);
    }

    .badge {
      display: inline-block;
      padding: 8px 18px;
      border-radius: 999px;
      font-weight: 700;
      margin-bottom: 14px;
    }

    .progress {
      height: 10px;
      background: #e5e7eb;
      border-radius: 999px;
      overflow: hidden;
      margin: 14px 0;
    }

    .progress > div {
      height: 100%;
    }

    .small {
      font-size: 14px;
      color: #6b7280;
      line-height: 1.6;
    }

    .hidden {
      display: none;
    }
  </style>
</head>

<body>
<div class="container">

  <h1>Thai Sentiment Analysis üåà</h1>
  <div class="subtitle">Machine Learning Web Deployment</div>

  <div class="card">
    <label>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</label>
    <textarea id="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå sentiment..."></textarea>

    <!-- SAMPLE CHIPS -->
    <div class="chips">
      <span class="chip pos" onclick="setText(randomBy('pos'))">üòä ‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å</span>
      <span class="chip neu" onclick="setText(randomBy('neu'))">üòê ‡∏Å‡∏•‡∏≤‡∏á</span>
      <span class="chip neg" onclick="setText(randomBy('neg'))">üò° ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö</span>
      <span class="chip mix" onclick="setText(randomBy('mix'))">üòï ‡∏õ‡∏£‡∏∞‡∏ä‡∏î</span>
    </div>

    <!-- ACTIONS -->
    <div class="actions">
      <div class="left-actions">
        <button class="primary" onclick="analyze()">Predict</button>
        <button class="secondary" onclick="setText(randomAny())">üé≤ ‡∏™‡∏∏‡πà‡∏°‡∏£‡∏ß‡∏°</button>
        <a href="/errors"><button class="secondary">üìä Error Analysis</button></a>
      </div>

      <div class="toggle">
        <span>A / B comparison</span>
        <input type="checkbox" id="abToggle">
      </div>
    </div>
  </div>

  <!-- RESULTS -->
  <div id="results" class="results hidden">
    <div id="modelA" class="result-card"></div>
    <div id="modelB" class="result-card"></div>
  </div>

</div>

<script>
  const samples = {
    pos: [
      "‡∏£‡πâ‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à‡∏™‡∏∏‡∏î‡πÜ üòä",
      "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢ ‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏®‡∏î‡∏µ‡∏°‡∏≤‡∏Å",
      "‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏∏‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏≠‡∏á"
    ],
    neu: [
      "‡∏£‡πâ‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡πá‡πÇ‡∏≠‡πÄ‡∏Ñ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏¢‡πà",
      "‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤",
      "‡πÄ‡∏â‡∏¢‡πÜ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à"
    ],
    neg: [
      "‡πÅ‡∏¢‡πà‡∏°‡∏≤‡∏Å ‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏ß‡∏•‡∏≤‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ üò°",
      "‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡πâ‡∏≤‡∏°‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤",
      "‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÅ‡∏¢‡πà‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î"
    ],
    mix: [
      "‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏î‡∏µ ‡πÅ‡∏ï‡πà‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏ú‡∏¥‡∏î‡∏´‡∏ß‡∏±‡∏á",
      "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢ ‡πÅ‡∏ï‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡πâ‡∏≤‡∏°‡∏≤‡∏Å",
      "‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏®‡∏î‡∏µ ‡πÅ‡∏ï‡πà‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏û‡∏á"
    ]
  };

  function randomBy(type) {
    const a = samples[type];
    return a[Math.floor(Math.random() * a.length)];
  }

  function randomAny() {
    const all = [...samples.pos, ...samples.neu, ...samples.neg, ...samples.mix];
    return all[Math.floor(Math.random() * all.length)];
  }

  function setText(t) {
    document.getElementById("text").value = t;
  }

  function styleByLabel(label) {
    if (label === "Positive") return ["var(--pos-bg)", "var(--pos-text)"];
    if (label === "Negative") return ["var(--neg-bg)", "var(--neg-text)"];
    return ["var(--neu-bg)", "var(--neu-text)"];
  }

  function render(el, d) {
    const [bg, color] = styleByLabel(d.label);
    el.style.background = bg;
    el.innerHTML = `
      <div class="badge" style="background:${bg};color:${color}">
        ${d.label.toUpperCase()}
      </div>
      <div class="progress">
        <div style="width:${d.confidence * 100}%;background:${color}"></div>
      </div>
      <div class="small">
        Confidence: ${(d.confidence * 100).toFixed(2)}%<br>
        Latency: ${d.latency_ms} ms<br>
        Model: ${d.name} <b>(${d.version ?? "v1.0"})</b>
      </div>
    `;
  }

  async function analyze() {
    const text = document.getElementById("text").value;
    const ab = document.getElementById("abToggle").checked;
    document.getElementById("results").classList.remove("hidden");

    if (ab) {
      const r = await fetch("/predict_ab", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ text })
      });
      const d = await r.json();
      render(modelA, d.model_a);
      render(modelB, d.model_b);
    } else {
      const r = await fetch("/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ text })
      });
      const d = await r.json();
      render(modelA, d);
      modelB.innerHTML = "";
    }
  }
</script>
</body>
</html>
